<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SP Trivia - Arcade Edition</title>
    <link rel="stylesheet" href="style.css">
    <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&family=Orbitron:wght@400;700&display=swap" rel="stylesheet">
</head>
<body>
    <div id="app-container">
        <header>
            <h1>SP Trivia</h1>
        </header>

        <main id="game-area">
            <!-- Initial Setup Screen -->
            <div id="initial-setup-screen" class="screen active">
                <h2>Welcome, Sports Fan!</h2>
                <input type="text" id="player-name" placeholder="Enter Your Name">
                <p id="player-name-error" class="error-message" style="display: none;"></p>
                <button id="go-to-mode-select">Next</button>
            </div>

            <!-- Mode Selection Screen -->
            <div id="mode-select-screen" class="screen">
                <h2>Choose Your Arena!</h2>
                <button class="mode-button" data-mode="singleplayer">Solo Challenge</button>
                <button class="mode-button" data-mode="head_to_head">Head-to-Head</button>
                <button class="mode-button" data-mode="multiplayer">Team Huddle (Multiplayer)</button>
                <button id="show-leaderboard-initial">View Hall of Fame</button>
            </div>

            <!-- Single Player Category Select Screen -->
            <div id="singleplayer-category-select-screen" class="screen">
                <h3>Solo Challenge - Select Categories</h3>
                <div id="category-selection-area">
                    <label>
                        <input type="checkbox" id="select-all-categories" value="all"> All Categories
                    </label>
                    <!-- Categories will be populated here by script.js -->
                </div>
                <button id="start-singleplayer-with-categories">Start Game</button>
                <button class="back-to-mode-select">Back</button>
            </div>

            <!-- Head-to-Head Config Screen -->
            <div id="head-to-head-config-screen" class="screen">
                <h3>Head-to-Head</h3>
                <div class="h2h-config-options-wrapper">
                    <div class="config-option"> <!-- Wrapper for label + select -->
                        <label for="h2h-primary-action-select">Action:</label>
                        <select id="h2h-primary-action-select"> <!-- Was opponent-type -->
                            <option value="create">Create Game</option> <!-- Default to Create -->
                            <option value="join">Join Game</option>
                        </select>
                    </div>

                    <!-- Options for Joining (shown if 'join' is selected) -->
                    <div id="h2h-join-options-container" style="display:none;"> <!-- Was h2h-join-game-options -->
                        <div class="config-option">
                            <label for="h2h-game-id-input">Game ID:</label> <!-- Was h2h-game-id-join -->
                            <input type="text" id="h2h-game-id-input" placeholder="Enter Game ID to Join">
                            <!-- Button removed from here -->
                        </div>
                    </div>

                    <!-- Options for Creating (shown if 'create' is selected) -->
                    <div id="h2h-create-options-container"> <!-- Was h2h-create-game-options -->
                        <div id="h2h-opponent-select-container" class="config-option"> <!-- Was h2h-opponent-type-container, moved inside -->
                            <label for="h2h-opponent-type-select">Opponent:</label>
                            <select id="h2h-opponent-type-select"> <!-- Existing ID from my previous change, ensure it's this one -->
                                <option value="bot">Bot</option>
                                <option value="player">Player</option>
                            </select>
                        </div>
                        <div class="config-option">
                            <label for="h2h-category-select">Category:</label>
                            <select id="h2h-category-select"></select> <!-- Existing ID -->
                        </div>
                        <div id="h2h-bot-level-options-container" class="config-option"> <!-- Was h2h-bot-level-container -->
                            <label for="h2h-bot-level-select">Bot Level:</label> <!-- Was h2h-bot-level -->
                            <select id="h2h-bot-level-select"> <!-- Was h2h-bot-level -->
                                <option value="easy">Easy</option>
                                <option value="medium">Medium</option>
                                <option value="hard">Hard</option>
                            </select>
                        </div>
                        <!-- Button removed from here -->
                    </div>
                </div> <!-- End h2h-config-options-wrapper -->

                <!-- Unified Action Button -->
                <button id="h2h-final-action-button" class="menu-button">Create Game</button> <!-- Text changes dynamically -->

                <button class="back-to-mode-select">Back</button>
                <div id="h2h-waiting-for-player" style="display: none;">
                    <p>Waiting for another player to join...</p>
                    <p>Room Code: <strong id="h2h-room-code-display"></strong></p>
                </div>
            </div>

            <!-- Multiplayer Config Screen -->
            <div id="multiplayer-config-screen" class="screen">
                <h3>Team Huddle</h3>
                <button id="create-multiplayer-room-btn">Create New Locker Room</button>
                <hr>
                <input type="text" id="multiplayer-game-id-join" placeholder="Enter Locker Room ID">
                <button id="join-multiplayer-room-btn">Join Existing Locker Room</button>
                <button class="back-to-mode-select">Back</button>
            </div>

            <!-- Multiplayer Host Options Screen (after creating a room) -->
            <div id="multiplayer-host-options-screen" class="screen">
                <h3>Locker Room <span id="host-room-id"></span> - Coach's Controls</h3>

                <div class="config-option">
                    <label for="multiplayer-max-players">Max Players (1-8):</label>
                    <input type="number" id="multiplayer-max-players" value="8" min="1" max="8">
                </div>

                <div class="config-option">
                    <label for="num-bots-multiplayer">Number of AI Players (0-7):</label>
                    <input type="number" id="num-bots-multiplayer" value="0" min="0" max="7">
                    <!-- JS should validate num_bots < max_players -->
                </div>
                
                <div class="config-option">
                    <label for="multiplayer-category-select">Category:</label>
                    <select id="multiplayer-category-select">
                        <option value="all">All Categories</option>
                        <!-- Options populated by script.js -->
                    </select>
                </div>
                <div class="config-option">
                    <label for="multiplayer-time-per-question">Time per Question (seconds):</label>
                    <input type="number" id="multiplayer-time-per-question" value="15" min="5" max="60">
                </div>
                <div class="config-option">
                    <label for="multiplayer-total-questions">Total Number of Questions:</label>
                    <input type="number" id="multiplayer-total-questions" value="10" min="5" max="50">
                </div>

                <p>Share Locker Room ID: <strong id="multiplayer-room-id-display"></strong></p>
                <button id="finalize-multiplayer-room-setup">Apply Config & Start Game</button>
                <div class="lobby-players-list">
                    <h4>Players in Lobby:</h4>
                    <ul id="multiplayer-lobby-players"></ul>
                </div>
                 <button class="back-to-mode-select">Cancel Room</button>
            </div>

            <!-- Game Lobby / Waiting Screen -->
            <div id="game-lobby-screen" class="screen">
                <h2>Game Lobby: <span id="lobby-game-id"></span></h2>
                <p>Arena: <span id="lobby-game-mode"></span></p>
                <p>Waiting for challengers... <span id="lobby-player-count">1</span>/<span id="lobby-max-players"></span></p>
                <div class="lobby-players-list">
                    <h4>Challengers:</h4>
                    <ul id="lobby-players-list-ul"></ul>
                </div>
                <div class="lobby-actions"> <!-- Added wrapper for buttons -->
                    <button id="start-game-button" style="display: none;">Start Game (Host)</button>
                    <button class="leave-lobby-button">Leave Lobby</button>
                </div>
                <p id="waiting-for-host-message">Waiting for host to start the game...</p>
            </div>

            <!-- Question Screen -->
            <div id="question-screen" class="screen">
                <div id="game-info-bar">
                    <span id="question-counter">Q: 1/30</span>
                    <span id="timer">Time: 15s</span>
                    <span id="current-score">Score: 0</span>
                </div>
                <h3 id="question-text">Which team won the Super Bowl in 2023?</h3>
                <div id="question-category-image-container">
                    <!-- Category image will be populated here by script.js -->
                </div>
                <div class="answers-grid">
                    <button class="answer-button" data-answer="A">Team A</button>
                    <button class="answer-button" data-answer="B">Team B</button>
                    <button class="answer-button" data-answer="C">Team C</button>
                    <button class="answer-button" data-answer="D">Team D</button>
                </div>
                <div id="feedback-message"></div>
                <button class="game-action-button exit-game-trigger">Exit Game</button>
            </div>

            <!-- Head-to-Head Game Screen (Question + Chat Side by Side) -->
            <div id="h2h-game-flex-container" class="screen">
                <div class="h2h-flex-row">
                    <div class="h2h-question-area">
                        <div id="h2h-game-info-bar">
                            <span id="h2h-question-counter">Q: 1/30</span>
                            <span id="h2h-timer">Time: 15s</span>
                            <span id="h2h-current-score">Score: 0</span>
                        </div>
                        <h3 id="h2h-question-text">Which team won the Super Bowl in 2023?</h3>
                        <div id="h2h-question-category-image-container">
                            <!-- Category image will be populated here by script.js -->
                        </div>
                        <div class="answers-grid">
                            <button class="answer-button" data-answer="A">Team A</button>
                            <button class="answer-button" data-answer="B">Team B</button>
                            <button class="answer-button" data-answer="C">Team C</button>
                            <button class="answer-button" data-answer="D">Team D</button>
                        </div>
                        <div id="h2h-feedback-message"></div>
                        <div id="h2h-lifeline-container" class="lifeline-button-container" style="display: none;">
                            <button id="h2h-fifty-fifty-btn" class="lifeline-button">50:50</button>
                            <button id="h2h-ninetieth-minute-btn" class="lifeline-button">90th Minute</button>
                            <button id="h2h-feelin-good-btn" class="lifeline-button">Feelin' Good</button>
                        </div>
                        <button class="game-action-button exit-game-trigger">Exit Game</button>
                    </div>
                    <div class="h2h-chat-area">
                        <div id="h2h-chat-container">
                            <h3>Chat</h3>
                            <div id="h2h-chat-messages"></div>
                            <div id="h2h-chat-input-area" class="chat-input-area">
                                <input type="text" id="h2h-chat-message-input" placeholder="Type a message...">
                                <button id="h2h-send-chat-message-btn">Send</button>
                            </div>
                            <div class="emoji-button-container">
                                <button class="emoji-button" data-emoji="üëç">üëç</button>
                                <button class="emoji-button" data-emoji="üòÇ">üòÇ</button>
                                <button class="emoji-button" data-emoji="ü§î">ü§î</button>
                                <button class="emoji-button" data-emoji="üî•">üî•</button>
                                <button class="emoji-button" data-emoji="üéâ">üéâ</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Multiplayer Game Screen (Question + Chat Side by Side) -->
            <div id="multiplayer-game-screen" class="screen">
                <div class="mp-flex-row">
                    <div class="mp-scoreboard-area">
                        <div id="mp-scoreboard-container">
                            <h3>Scoreboard</h3>
                            <ul id="mp-scoreboard-list">
                                <!-- Player scores will be populated here by script.js -->
                            </ul>
                        </div>
                    </div>
                    <div class="mp-question-area">
                        <div id="mp-game-info-bar">
                            <span id="mp-question-counter">Q: 1/10</span>
                            <span id="mp-timer">Time: 15s</span>
                            <span id="mp-current-score">Score: 0</span>
                        </div>
                        <h3 id="mp-question-text">Multiplayer Question Text...</h3>
                        <div id="mp-question-category-image-container">
                            <!-- Category image will be populated here -->
                        </div>
                        <div class="answers-grid" id="mp-answers-grid">
                            <button class="answer-button" data-answer="A">Answer A</button>
                            <button class="answer-button" data-answer="B">Answer B</button>
                            <button class="answer-button" data-answer="C">Answer C</button>
                            <button class="answer-button" data-answer="D">Answer D</button>
                        </div>
                        <div id="mp-feedback-message"></div>
                        <div id="mp-lifeline-container" class="lifeline-button-container" style="display: none;">
                            <button id="mp-fifty-fifty-btn" class="lifeline-button">50:50</button>
                            <button id="mp-ninetieth-minute-btn" class="lifeline-button">90th Minute</button>
                            <button id="mp-feelin-good-btn" class="lifeline-button">Feelin' Good</button>
                        </div>
                        <button class="game-action-button exit-game-trigger">Exit Game</button>
                    </div>
                    <div class="mp-chat-area">
                        <div id="mp-chat-container">
                            <h3>Chat</h3>
                            <div id="mp-chat-messages"></div>
                            <div id="mp-chat-input-area" class="chat-input-area">
                                <input type="text" id="mp-chat-message-input" placeholder="Type a message...">
                                <button id="mp-send-chat-message-btn">Send</button>
                            </div>
                            <div class="emoji-button-container" id="mp-emoji-button-container">
                                <button class="emoji-button" data-emoji="üëç">üëç</button>
                                <button class="emoji-button" data-emoji="üòÇ">üòÇ</button>
                                <button class="emoji-button" data-emoji="ü§î">ü§î</button>
                                <button class="emoji-button" data-emoji="üî•">üî•</button>
                                <button class="emoji-button" data-emoji="üéâ">üéâ</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Game Over Screen -->
            <div id="game-over-screen" class="screen">
                <h2>Full Time!</h2>
                <div id="final-scores"> <!-- Changed from final-score-details -->
                    <!-- Final scores will be populated here -->
                </div>
                <div id="winner-message-container" class="winner-message">
                    <!-- Winner message will be displayed here by JavaScript -->
                </div>
                <p id="game-over-feedback"></p> <!-- Added for general feedback if needed -->
                <button id="play-again-btn">Rematch!</button> <!-- Changed from play-again -->
                <button id="back-to-main-menu-from-game-over-btn">Main Menu</button> <!-- Changed from back-to-main-menu -->
                <button id="show-leaderboard-gameover">View Hall of Fame</button>
            </div>

            <!-- Leaderboard Screen -->
            <div id="leaderboard-screen" class="screen">
                <h2>Hall of Fame</h2>
                <table id="leaderboard-table">
                    <thead>
                        <tr>
                            <th>Rank</th>
                            <th>Name</th>
                            <th>Score</th>
                            <th>Date</th>
                        </tr>
                    </thead>
                    <tbody id="leaderboard-body">
                        <!-- Leaderboard entries will be populated here -->
                    </tbody>
                </table>
                <button id="back-from-leaderboard">Back</button>
            </div>

        </main>

        <footer>
            <p>&copy; 2025 SP Trivia - Arcade Edition</p>
        </footer>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.0.1/socket.io.js"></script>
    <script src="script.js"></script>
</body>
</html>
